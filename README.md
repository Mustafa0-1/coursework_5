# coursework_5
**Краткое описание задачи**

Задание будет представлять собой маленькую игру с веб-интерфейсом о битве героев 
в стиле олдскульных браузерных игр.

Здесь мы закрепим навыки по ООП, типизации данных, использованию датаклассов и паттернов, 
а также описанию Docker-контейнеров, настройке nginx и Gunicorn.

## **Знания для разработки проекта**

- [ ]  Основы объектно-ориентированного программирования.
- [ ]  Работа с датаклассами.
- [ ]  Навыки функционального программирования, 
использование библиотек marshmallow и marshmallow_dataclasses.
- [ ]  Основы типизации данных.
- [ ]  Работа с данными в  формате JSON.
- [ ]  Основы работы с Flask, использование шаблонов во Flask.
- [ ]  Основы работы с Docker и nginx

## **Этапы разработки проекта**

- Разработка логики проекта.
- Подключение Flask-приложения.

## Как работает готовый проект – “флоу” проекта

1. При переходе на основную страничку с игрой пользователь видит название и кнопку **«Начать игру»** (используем шаблон `index.html`).
2. При нажатии кнопки «Начать игру» пользователь переходит по адресу `/choose-hero/`.

На экране появляется форма, которая принимает следующие данные 
(используем шаблон `choose-hero.html`):

- Название страницы (тег `h2`) («Выберите героя» или «Выберите врага»).
- Предложение ввести имя героя (тег `input`).
- Предложение выбрать класс героя (тег`select`), сформированный на основе названий классов, доступных в программе.
- Предложение выбрать оружие (тег`select`), сформированный на основе имеющихся видов оружия, доступных в программе (исходя из сведений файла `equipment.json`, находится в папке data).
- Предложение выбрать броню (тег`select`), сформированный на основе имеющихся видов брони, доступных в программе (также исходя из сведений файла `equipment.json`).
- Кнопка для отправки заполненных данных.
    
   
1. После отправки данных появляется аналогичная форма для выбора параметров противника (используем шаблон `choose_hero.html`).
2. После того, как основные параметры выбраны, начинается самое интересное!
(Используем шаблон `fight.html`.)

Вторая кнопка для отправки данных перенаправляет нас по адресу `/fight/`, и появляется экран битвы:

Здесь мы видим данные о герое (слева) и данные о противнике (справа). Данные как о герое, так и о противнике делятся на блоки. Рассмотрим их более подробно. 

### Характеристики персонажей

Персонажи в данной игре будут иметь три блока с характеристиками:

- Характеристика класса персонажа.
    
    **Характеристика класса персонажа включает в себя:**
    
    - Название (Вор, Воин) (name).
    - Максимальное число очков здоровья (max_health).
    - Максимальное число очков выносливости (max_stamina).
    - Модификатор атаки (attack).
    - Модификатор защиты (armor).
    - Модификатор выносливости (stamina).
    - Умение (skill).
    
   
    - имя,
    - урон,
    - требуемая выносливость.
    
    
- Характеристика оружия персонажа.
    
    ***Характеристика оружия персонажа включает в себя:***
    
    - Название (name).
    - Минимальный урон (min_damage).
    - Максимальный урон (max_damage).
    - Количество затрачиваемой выносливости за удар (stamina_per_hit).
    
    Данные с предлагаемым оружием хранятся в формате JSON в файле equipment.json и выглядят так:
    
    ```json
    {
        "id": 1,
        "name": "топорик",
        "min_damage": 2.5,
        "max_damage": 4.1,
        "stamina_per_hit": 2
    }
    ```
    
- Характеристика брони персонажа.
    
    ***Характеристика брони персонажа включает в себя:***
    
    - Название.
    - Очки защиты.
    - Количество затрачиваемой выносливости за ход (stamina_per_turn).
        
        ```json
        {
            "id": 2,
            "name":"кожаная броня",
            "defence": 1.2,
            "stamina_per_turn": 1
        }
        ```
        

### **Механика боя**

Бой состоит из ходов. В течение 1 хода игрок может нанести удар, воспользоваться умением или пропустить ход.

Каждый новый ход выносливости игроков увеличивается на 3 ед. (Не может превышать максимальное значение.)

Бой происходит с компьютерным противником. После действия игрока компьютер отвечает тем же. 

Как игрок, так и компьютер могут использовать умение только один раз за бой.

Когда компьютер выполняет ответное действие, он имеет 10%-ный шанс воспользоваться умением. Если шанс срабатывает, а умение уже было применено, то компьютер наносит обычный удар.

Битва окончена, если у одного из персонажей очки здоровья меньше нуля.

Предполагается 3 исхода битвы:

- Игрок победил.
- Игрок проиграл.
- Ничья.

 

Экран имеет 4 кнопки.

### 1. **Кнопка «Нанести удар»**

При нажатии на кнопку происходит проверка, достаточно ли у персонажа выносливости, чтобы нанести удар. Если выносливости недостаточно, пропускаем ход. Если достаточно, тогда переходим к расчету количества урона.
Урон рассчитывается следующим образом:
`УРОН = УРОН_АТАКУЮЩЕГО - БРОНЯ_ЦЕЛИ`

`урон_от_оружия = случайное число в диапазоне (min_damage - max_damage)`
`УРОН_АТАКУЮЩЕГО = урон_от_оружия * модификатор_атаки_класса`

Далее перед тем, как рассчитать броню цели, необходимо провести проверку на выносливость. 
Как мы помним, броня имеет характеристику `stamina_per_turn`.

Если у персонажа, которого атакуют, достаточно очков выносливости для использования своей брони, тогда рассчитываем показатель брони цели следующим образом:

       `БРОНЯ_ЦЕЛИ = надетая_броня * модификатор_брони_класса`

Если у персонажа, которого атакуют, очков выносливости для использования своей брони недостаточно, тогда его броня игнорируется.
После того, как все расчеты произведены, вычитаем из очков здоровья цели показатель рассчитанного урона.

**Как рассчитывается выносливость в бою**
В каждом бою у нас будет задана константа, сколько очков выносливости персонаж восстанавливает за ход.

Таким образом, в целом расчет выносливости выглядит следующим образом:

- У атакующего вычитаем количество затраченной выносливости на удар (`stamina_per_hit`).
- У защищающегося вычитаем количество затраченной выносливости за защиту (`stamina_per_turn`).

**Восстанавливаем выносливость атакующего и защищающего:**

- Прибавляем к очкам выносливости атакующего константу, умноженную на модификатор выносливости **атакующего.**
- Прибавляем к очкам выносливости цели константу, умноженную на модификатор выносливости **цели.**

После того, как все расчеты произведены, компьютерный противник наносит ответный удар, который рассчитывается аналогичным образом.

### 2. **Кнопка «Использовать умение»**

При использовании умения происходит только проверка, достаточно ли выносливости у персонажа, использующего умение. Все остальные проверки игнорируются.

Если проверка пройдена успешно, тогда вычитаем очки здоровья цели в соответствии с примененным умением.

### 3. **Кнопка «Пропустить ход»**

Игрок пропускает ход. После чего компьютерный противник совершает действие.

### 4. **Кнопка «Завершить бой»**

Переходим на страницу с кнопкой «Начать игру» и начинаем всё сначала =)